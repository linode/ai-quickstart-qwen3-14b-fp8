#cloud-config

# Set hostname
hostname: _INSTANCE_LABEL_PLACEHOLDER_

# Update system packages
package_update: true
package_upgrade: true

# Install base dependencies
packages:
  - ca-certificates
  - curl
  - gnupg
  - lsb-release
  - jq
  - btop
  - nvtop
  - ubuntu-drivers-common

# Files to write
write_files:
  - path: /opt/_PROJECT_NAME_PLACEHOLDER_/docker-compose.yml
    permissions: '0644'
    encoding: base64
    content: _DOCKER_COMPOSE_BASE64_CONTENT_PLACEHOLDER_

  - path: /opt/_PROJECT_NAME_PLACEHOLDER_/Caddyfile
    permissions: '0644'
    encoding: base64
    content: _CADDYFILE_BASE64_CONTENT_PLACEHOLDER_

  - path: /opt/_PROJECT_NAME_PLACEHOLDER_/install.sh
    permissions: '0755'
    encoding: base64
    content: _INSTALL_SH_BASE64_CONTENT_PLACEHOLDER_

# Run install script
runcmd:
  - bash /opt/_PROJECT_NAME_PLACEHOLDER_/install.sh
